<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">testReport.html</title>
      <link href="assets\style.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <h1 id="title">testReport.html</h1>
    <p>Report generated on 21-May-2025 at 23:33:28 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">14 tests took 00:00:02.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">4 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">10 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" disabled/>
            <span class="skipped">0 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" disabled/>
            <span class="rerun">0 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.12.2&#34;, &#34;Platform&#34;: &#34;Windows-11-10.0.26100-SP0&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.3.5&#34;, &#34;pluggy&#34;: &#34;1.6.0&#34;}, &#34;Plugins&#34;: {&#34;html&#34;: &#34;4.1.1&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;}}, &#34;tests&#34;: {&#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_sales_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_sales_data_to_staging&#34;, &#34;duration&#34;: &#34;330 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_sales_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;330 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:45 This is pre test fixture...\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\nINFO     conftest:conftest.py:23 Postgres connection is being established...\nINFO     conftest:conftest.py:26 Postgres connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:28 Test cases execution for sales_data extraction from source started ....\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:33 Test cases execution for sales_data extraction from source completed ....\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:29 Postgres connection has been closed..\nINFO     conftest:conftest.py:40 mysql connection has been closed..\nINFO     conftest:conftest.py:47 This is post test fixture...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_product_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_product_data_to_staging&#34;, &#34;duration&#34;: &#34;247 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_product_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;247 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:45 This is pre test fixture...\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\nINFO     conftest:conftest.py:23 Postgres connection is being established...\nINFO     conftest:conftest.py:26 Postgres connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:40 Test cases execution for product_data extraction from source started ....\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:45 Test cases execution for product_data extraction from source completed ....\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:29 Postgres connection has been closed..\nINFO     conftest:conftest.py:40 mysql connection has been closed..\nINFO     conftest:conftest.py:47 This is post test fixture...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_inventory_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_inventory_data_to_staging&#34;, &#34;duration&#34;: &#34;250 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_inventory_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;250 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:45 This is pre test fixture...\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\nINFO     conftest:conftest.py:23 Postgres connection is being established...\nINFO     conftest:conftest.py:26 Postgres connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:52 Test cases execution for inventory_data extraction from source started ....\nERROR    CommonUtilities.utils:utils.py:36 data extraction from sales did not happen correctly lxml not found, please install or use the etree parser.\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:57 Test cases execution for inventory_data extraction from source completed ....\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:29 Postgres connection has been closed..\nINFO     conftest:conftest.py:40 mysql connection has been closed..\nINFO     conftest:conftest.py:47 This is post test fixture...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_supplier_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_supplier_data_to_staging&#34;, &#34;duration&#34;: &#34;256 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_supplier_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;256 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:45 This is pre test fixture...\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\nINFO     conftest:conftest.py:23 Postgres connection is being established...\nINFO     conftest:conftest.py:26 Postgres connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:64 Test cases execution for supplier_data extraction from source started ....\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:29 Postgres connection has been closed..\nINFO     conftest:conftest.py:40 mysql connection has been closed..\nINFO     conftest:conftest.py:47 This is post test fixture...&#34;}], &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_store_data_to_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_store_data_to_staging&#34;, &#34;duration&#34;: &#34;289 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataExtraction.py::TestDataExtraction::test_DataExtraction_store_data_to_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;289 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:45 This is pre test fixture...\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\nINFO     conftest:conftest.py:23 Postgres connection is being established...\nINFO     conftest:conftest.py:26 Postgres connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataExtraction:test_DataExtraction.py:75 Test cases execution for stores_data extraction from source started ....\nINFO     CommonUtilities.utils:utils.py:42 The expected data is :  store_id    store_name\n0      1.0       Walmart\n1      2.0        Target\n2      3.0      Best Buy\n3      4.0        Costco\n4      5.0    Home Depot\n5      6.0        Lowe&amp;#x27;s\n6      7.0   Apple Store\n7      8.0          IKEA\n8      9.0     Walgreens\n9     10.0  CVS Pharmacy\nINFO     CommonUtilities.utils:utils.py:44 The actual data is:   store_id    store_name\n0      1.0       Walmart\n1      2.0        Target\n2      3.0      Best Buy\n3      4.0        Costco\n4      5.0    Home Depot\n5      6.0        Lowe&amp;#x27;s\n6      7.0   Apple Store\n7      8.0          IKEA\n8      9.0     Walgreens\n9     10.0  CVS Pharmacy\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:29 Postgres connection has been closed..\nINFO     conftest:conftest.py:40 mysql connection has been closed..\nINFO     conftest:conftest.py:47 This is post test fixture...&#34;}], &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_sales_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_sales_check&#34;, &#34;duration&#34;: &#34;48 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_fact_sales_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;48 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;query_expected = &amp;#x27;select sales_id,product_id,store_id,quantity,sales_amount,sale_date from \\n            sales_with_details order by sales_id,product_id,store_id&amp;#x27;\ndb_engine_expected = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19916270&amp;gt;\nquery_actual = &amp;#x27;select sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales \\n            order by sales_id,product_id,store_id&amp;#x27;\ndb_engine_actual = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19916270&amp;gt;\n\n    def verify_expected_from_db_to_actual_from_db(query_expected, db_engine_expected, query_actual, db_engine_actual):\n        try:\n            df_expected = pd.read_sql(query_expected, db_engine_expected).astype(str)\n            logger.info(f&amp;quot;The expected data is :{df_expected}&amp;quot;)\n            df_actual = pd.read_sql(query_actual, db_engine_actual).astype(str)\n            logger.info(f&amp;quot;The actual data is: {df_actual}&amp;quot;)\n&amp;gt;           assert df_actual.equals(df_expected), &amp;quot;data does not match between expected and actual&amp;quot;\nE           AssertionError: data does not match between expected and actual\n\nCommonUtilities\\utils.py:45: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x000001AC1989CF50&amp;gt;\nconnect_to_mysql_db = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19916270&amp;gt;\n\n    def test_DataLoad_fact_sales_check(self, connect_to_mysql_db):\n        logger.info(&amp;quot;Test cases execution for fact_sales data load has started ....&amp;quot;)\n        try:\n            expected_query = &amp;quot;&amp;quot;&amp;quot;select sales_id,product_id,store_id,quantity,sales_amount,sale_date from\n            sales_with_details order by sales_id,product_id,store_id&amp;quot;&amp;quot;&amp;quot;\n            actual_query = &amp;quot;&amp;quot;&amp;quot;select sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales\n            order by sales_id,product_id,store_id&amp;quot;&amp;quot;&amp;quot;\n&amp;gt;           verify_expected_from_db_to_actual_from_db(expected_query, connect_to_mysql_db, actual_query,\n                                                      connect_to_mysql_db)\n\nTestScripts\\test_DataLoading.py:33: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nquery_expected = &amp;#x27;select sales_id,product_id,store_id,quantity,sales_amount,sale_date from \\n            sales_with_details order by sales_id,product_id,store_id&amp;#x27;\ndb_engine_expected = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19916270&amp;gt;\nquery_actual = &amp;#x27;select sales_id,product_id,store_id,quantity,total_sales,sale_date from fact_sales \\n            order by sales_id,product_id,store_id&amp;#x27;\ndb_engine_actual = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19916270&amp;gt;\n\n    def verify_expected_from_db_to_actual_from_db(query_expected, db_engine_expected, query_actual, db_engine_actual):\n        try:\n            df_expected = pd.read_sql(query_expected, db_engine_expected).astype(str)\n            logger.info(f&amp;quot;The expected data is :{df_expected}&amp;quot;)\n            df_actual = pd.read_sql(query_actual, db_engine_actual).astype(str)\n            logger.info(f&amp;quot;The actual data is: {df_actual}&amp;quot;)\n            assert df_actual.equals(df_expected), &amp;quot;data does not match between expected and actual&amp;quot;\n    \n        except Exception as e:\n            logger.error(f&amp;quot;data does not match between expected and actual{e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;data does not match between expected and actual&amp;quot;)\nE           Failed: data does not match between expected and actual\n\nCommonUtilities\\utils.py:49: Failed\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:27 Test cases execution for fact_sales data load has started ....\nINFO     CommonUtilities.utils:utils.py:42 The expected data is :   sales_id product_id store_id quantity sales_amount   sale_date\n0        10        110      4.0        9        153.0  2024-09-10\n1        11        101      4.0       15        210.0  2024-09-11\n2        12        102      5.0        9        243.0  2024-09-12\n3        13        103      6.0       10        220.0  2024-09-13\n4        14        104      7.0        8        248.0  2024-09-14\n5        15        105      4.0       12        132.0  2024-09-15\n6        16        106      5.0        5        115.0  2024-09-16\n7        17        107      6.0        3         78.0  2024-09-17\n8        18        108      7.0        6        168.0  2024-09-18\n9        19        109      8.0       11        220.0  2024-09-19\n10       20        110      9.0        9        175.5  2024-09-20\n11       21        101      1.0       14        217.0  2024-09-21\n12       22        102      2.0        8        176.0  2024-09-22\n13       23        103      3.0        7        126.0  2024-09-23\n14       24        104      4.0        6        150.0  2024-09-24\n15       25        105      2.0       12        162.0  2024-09-25\n16       26        106      3.0        5        105.0  2024-09-26\n17       27        107      1.0       10        190.0  2024-09-27\n18       28        108      5.0        6        162.0  2024-09-28\n19       29        109      6.0        9        216.0  2024-09-29\n20       30        110      7.0        7        164.5  2024-09-30\n21       31        101      4.0       13        188.5  2024-10-01\n22       32        102      5.0        6        174.0  2024-10-02\n23       33        103      6.0        8        168.0  2024-10-03\n24       34        104      7.0        5        150.0  2024-10-04\n25       35        105      4.0        7        105.0  2024-10-05\n26       36        106      5.0        3         75.0  2024-10-06\n27       37        107      6.0       12        216.0  2024-10-07\n28       38        108      7.0        9        180.0  2024-10-08\n29       39        109      8.0       10        220.0  2024-10-09\n30       40        110      9.0        6        156.0  2024-10-10\n31       41        101      3.0        5         75.0  2024-10-11\n32       42        102      4.0        4         80.0  2024-10-12\n33       43        103      5.0        9        171.0  2024-10-13\n34       44        104      6.0        7        196.0  2024-10-14\n35       45        105      7.0       10        250.0  2024-10-15\n36       46        106      8.0        8        180.0  2024-10-16\n37       47        107      9.0        6        144.0  2024-10-17\n38       48        108      1.0        3         81.0  2024-10-18\n39       49        109      2.0       11        203.5  2024-10-19\n40       50        110      3.0       12        252.0  2024-10-20\n41       60        110      4.0        9        153.0  2024-09-10\nINFO     CommonUtilities.utils:utils.py:44 The actual data is:    sales_id product_id store_id quantity total_sales   sale_date\n0        10        110        4        9       153.0  2024-09-10\n1        11        101        4       15       210.0  2024-09-11\n2        12        102        5        9       243.0  2024-09-12\n3        13        103        6       10       220.0  2024-09-13\n4        14        104        7        8       248.0  2024-09-14\n5        15        105        4       12       132.0  2024-09-15\n6        16        106        5        5       115.0  2024-09-16\n7        17        107        6        3        78.0  2024-09-17\n8        18        108        7        6       168.0  2024-09-18\n9        19        109        8       11       220.0  2024-09-19\n10       20        110        9        9       175.5  2024-09-20\n11       21        101        1       14       217.0  2024-09-21\n12       22        102        2        8       176.0  2024-09-22\n13       23        103        3        7       126.0  2024-09-23\n14       24        104        4        6       150.0  2024-09-24\n15       25        105        2       12       162.0  2024-09-25\n16       26        106        3        5       105.0  2024-09-26\n17       27        107        1       10       190.0  2024-09-27\n18       28        108        5        6       162.0  2024-09-28\n19       29        109        6        9       216.0  2024-09-29\n20       30        110        7        7       164.5  2024-09-30\n21       31        101        4       13       188.5  2024-10-01\n22       32        102        5        6       174.0  2024-10-02\n23       33        103        6        8       168.0  2024-10-03\n24       34        104        7        5       150.0  2024-10-04\n25       35        105        4        7       105.0  2024-10-05\n26       36        106        5        3        75.0  2024-10-06\n27       37        107        6       12       216.0  2024-10-07\n28       38        108        7        9       180.0  2024-10-08\n29       39        109        8       10       220.0  2024-10-09\n30       40        110        9        6       156.0  2024-10-10\n31       41        101        3        5        75.0  2024-10-11\n32       42        102        4        4        80.0  2024-10-12\n33       43        103        5        9       171.0  2024-10-13\n34       44        104        6        7       196.0  2024-10-14\n35       45        105        7       10       250.0  2024-10-15\n36       46        106        8        8       180.0  2024-10-16\n37       47        107        9        6       144.0  2024-10-17\n38       48        108        1        3        81.0  2024-10-18\n39       49        109        2       11       203.5  2024-10-19\n40       50        110        3       12       252.0  2024-10-20\n41       60        110        4        9       153.0  2024-09-10\nERROR    CommonUtilities.utils:utils.py:48 data does not match between expected and actualdata does not match between expected and actual\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:40 mysql connection has been closed..&#34;}], &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_Sales_Summary_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_Sales_Summary_check&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataLoading.py::TestDataLoading::test_DataLoad_Sales_Summary_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;query_expected = &amp;#x27;select product_id,month,year,total_sales from monthly_sales_summary_source&amp;#x27;\ndb_engine_expected = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19937C20&amp;gt;\nquery_actual = &amp;#x27;select product_id,month,year,total_sales from monthly_sales_summary&amp;#x27;\ndb_engine_actual = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19937C20&amp;gt;\n\n    def verify_expected_from_db_to_actual_from_db(query_expected, db_engine_expected, query_actual, db_engine_actual):\n        try:\n            df_expected = pd.read_sql(query_expected, db_engine_expected).astype(str)\n            logger.info(f&amp;quot;The expected data is :{df_expected}&amp;quot;)\n            df_actual = pd.read_sql(query_actual, db_engine_actual).astype(str)\n            logger.info(f&amp;quot;The actual data is: {df_actual}&amp;quot;)\n&amp;gt;           assert df_actual.equals(df_expected), &amp;quot;data does not match between expected and actual&amp;quot;\nE           AssertionError: data does not match between expected and actual\n\nCommonUtilities\\utils.py:45: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataLoading.TestDataLoading object at 0x000001AC1989D1F0&amp;gt;\nconnect_to_mysql_db = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19937C20&amp;gt;\n\n    def test_DataLoad_Sales_Summary_check(self, connect_to_mysql_db):\n        logger.info(&amp;quot;Test cases execution for sales_summary data load has started ....&amp;quot;)\n        try:\n            expected_query = &amp;quot;&amp;quot;&amp;quot;select product_id,month,year,total_sales from monthly_sales_summary_source&amp;quot;&amp;quot;&amp;quot;\n            actual_query = &amp;quot;&amp;quot;&amp;quot;select product_id,month,year,total_sales from monthly_sales_summary&amp;quot;&amp;quot;&amp;quot;\n&amp;gt;           verify_expected_from_db_to_actual_from_db(expected_query, connect_to_mysql_db, actual_query,\n                                                      connect_to_mysql_db)\n\nTestScripts\\test_DataLoading.py:45: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nquery_expected = &amp;#x27;select product_id,month,year,total_sales from monthly_sales_summary_source&amp;#x27;\ndb_engine_expected = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19937C20&amp;gt;\nquery_actual = &amp;#x27;select product_id,month,year,total_sales from monthly_sales_summary&amp;#x27;\ndb_engine_actual = &amp;lt;sqlalchemy.engine.base.Connection object at 0x000001AC19937C20&amp;gt;\n\n    def verify_expected_from_db_to_actual_from_db(query_expected, db_engine_expected, query_actual, db_engine_actual):\n        try:\n            df_expected = pd.read_sql(query_expected, db_engine_expected).astype(str)\n            logger.info(f&amp;quot;The expected data is :{df_expected}&amp;quot;)\n            df_actual = pd.read_sql(query_actual, db_engine_actual).astype(str)\n            logger.info(f&amp;quot;The actual data is: {df_actual}&amp;quot;)\n            assert df_actual.equals(df_expected), &amp;quot;data does not match between expected and actual&amp;quot;\n    \n        except Exception as e:\n            logger.error(f&amp;quot;data does not match between expected and actual{e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;data does not match between expected and actual&amp;quot;)\nE           Failed: data does not match between expected and actual\n\nCommonUtilities\\utils.py:49: Failed\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataLoading:test_DataLoading.py:41 Test cases execution for sales_summary data load has started ....\nINFO     CommonUtilities.utils:utils.py:42 The expected data is :   product_id month  year total_sales\n0         110     9  2024       646.0\n1         101     9  2024       427.0\n2         102     9  2024       419.0\n3         103     9  2024       346.0\n4         104     9  2024       398.0\n5         105     9  2024       294.0\n6         106     9  2024       220.0\n7         107     9  2024       268.0\n8         108     9  2024       330.0\n9         109     9  2024       436.0\n10        101    10  2024       263.5\n11        102    10  2024       254.0\n12        103    10  2024       339.0\n13        104    10  2024       346.0\n14        105    10  2024       355.0\n15        106    10  2024       255.0\n16        107    10  2024       360.0\n17        108    10  2024       261.0\n18        109    10  2024       423.5\n19        110    10  2024       408.0\nINFO     CommonUtilities.utils:utils.py:44 The actual data is: Empty DataFrame\nColumns: [product_id, month, year, total_sales]\nIndex: []\nERROR    CommonUtilities.utils:utils.py:48 data does not match between expected and actualdata does not match between expected and actual\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:40 mysql connection has been closed..&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_availabilty_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_availabilty_check&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_availabilty_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataQuality:test_DataQuality.py:27 Test cases for supplier_data- file availability check has started ....\n\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_zero_byte_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_zero_byte_check&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_zero_byte_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataQuality:test_DataQuality.py:36 Test cases for supplier_data- zero byte size check has started ....\n\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_duplicate_row_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_duplicate_row_check&#34;, &#34;duration&#34;: &#34;2 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_duplicate_row_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;2 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;TestScripts.test_DataQuality.TestDataQuality object at 0x000001AC1989D940&amp;gt;\n\n    def test_DataQuality_supplier_data_File_duplicate_row_check(self):\n        logger.info(&amp;quot;Test cases for supplier_data- duplicate row check has started ....&amp;quot;)\n        try:\n&amp;gt;           assert check_duplicates_rows(&amp;quot;TestData/supplier_data.json&amp;quot;,\n                                         &amp;quot;json&amp;quot;) == True, &amp;quot;Supplier_data.json file has duplicate rows&amp;quot;\nE                                        AssertionError: Supplier_data.json file has duplicate rows\nE                                        assert None == True\nE                                         +  where None = check_duplicates_rows(&amp;#x27;TestData/supplier_data.json&amp;#x27;, &amp;#x27;json&amp;#x27;)\n\nTestScripts\\test_DataQuality.py:47: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataQuality.TestDataQuality object at 0x000001AC1989D940&amp;gt;\n\n    def test_DataQuality_supplier_data_File_duplicate_row_check(self):\n        logger.info(&amp;quot;Test cases for supplier_data- duplicate row check has started ....&amp;quot;)\n        try:\n            assert check_duplicates_rows(&amp;quot;TestData/supplier_data.json&amp;quot;,\n                                         &amp;quot;json&amp;quot;) == True, &amp;quot;Supplier_data.json file has duplicate rows&amp;quot;\n        except Exception as e:\n            logger.error(f&amp;quot; error occurred during test {e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;error occurred during test&amp;quot;)\nE           Failed: error occurred during test\n\nTestScripts\\test_DataQuality.py:51: Failed\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataQuality:test_DataQuality.py:45 Test cases for supplier_data- duplicate row check has started ....\nERROR    CommonUtilities.utils:utils.py:94 error while reading the file unsupported file type passed TestData/supplier_data.json\nERROR    TestScripts.test_DataQuality:test_DataQuality.py:50  error occurred during test Supplier_data.json file has duplicate rows\nassert None == True\n +  where None = check_duplicates_rows(&amp;#x27;TestData/supplier_data.json&amp;#x27;, &amp;#x27;json&amp;#x27;)\n\n&#34;}], &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_missing_data_or_null_vaule_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_missing_data_or_null_vaule_check&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataQuality.py::TestDataQuality::test_DataQuality_supplier_data_File_missing_data_or_null_vaule_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;self = &amp;lt;TestScripts.test_DataQuality.TestDataQuality object at 0x000001AC1989DA60&amp;gt;\n\n    def test_DataQuality_supplier_data_File_missing_data_or_null_vaule_check(self):\n        logger.info(&amp;quot;Test cases for supplier_data- null value heck has started ....&amp;quot;)\n        try:\n&amp;gt;           assert check_duplicates_rows(&amp;quot;TestData/supplier_data.json&amp;quot;,\n                                         &amp;quot;json&amp;quot;) == True, &amp;quot;Supplier_data.json file has some null values&amp;quot;\nE                                        AssertionError: Supplier_data.json file has some null values\nE                                        assert None == True\nE                                         +  where None = check_duplicates_rows(&amp;#x27;TestData/supplier_data.json&amp;#x27;, &amp;#x27;json&amp;#x27;)\n\nTestScripts\\test_DataQuality.py:56: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = &amp;lt;TestScripts.test_DataQuality.TestDataQuality object at 0x000001AC1989DA60&amp;gt;\n\n    def test_DataQuality_supplier_data_File_missing_data_or_null_vaule_check(self):\n        logger.info(&amp;quot;Test cases for supplier_data- null value heck has started ....&amp;quot;)\n        try:\n            assert check_duplicates_rows(&amp;quot;TestData/supplier_data.json&amp;quot;,\n                                         &amp;quot;json&amp;quot;) == True, &amp;quot;Supplier_data.json file has some null values&amp;quot;\n        except Exception as e:\n            logger.error(f&amp;quot; error occurred during test {e}&amp;quot;)\n&amp;gt;           pytest.fail(&amp;quot;error occurred during test&amp;quot;)\nE           Failed: error occurred during test\n\nTestScripts\\test_DataQuality.py:60: Failed\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataQuality:test_DataQuality.py:54 Test cases for supplier_data- null value heck has started ....\nERROR    CommonUtilities.utils:utils.py:94 error while reading the file unsupported file type passed TestData/supplier_data.json\nERROR    TestScripts.test_DataQuality:test_DataQuality.py:59  error occurred during test Supplier_data.json file has some null values\nassert None == True\n +  where None = check_duplicates_rows(&amp;#x27;TestData/supplier_data.json&amp;#x27;, &amp;#x27;json&amp;#x27;)\n\n&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Filter_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Filter_check&#34;, &#34;duration&#34;: &#34;63 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Filter_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;63 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:29 Test cases execution for filter Transformation started...\nINFO     CommonUtilities.utils:utils.py:42 The expected data is :   sales_id product_id store_id quantity price   sale_date region\n0        10        110        4        9  17.0  2024-09-10    Low\n1        11        101        4       15  14.0  2024-09-11   High\n2        12        102        5        9  27.0  2024-09-12    Low\n3        13        103        6       10  22.0  2024-09-13   High\n4        14        104        7        8  31.0  2024-09-14    Low\n5        15        105        4       12  11.0  2024-09-15   High\n6        16        106        5        5  23.0  2024-09-16    Low\n7        17        107        6        3  26.0  2024-09-17   High\n8        18        108        7        6  28.0  2024-09-18    Low\n9        19        109        8       11  20.0  2024-09-19   High\n10       20        110        9        9  19.5  2024-09-20    Low\n11       21        101        1       14  15.5  2024-09-21   High\n12       22        102        2        8  22.0  2024-09-22    Low\n13       23        103        3        7  18.0  2024-09-23   High\n14       24        104        4        6  25.0  2024-09-24    Low\n15       25        105        2       12  13.5  2024-09-25   High\n16       26        106        3        5  21.0  2024-09-26    Low\n17       27        107        1       10  19.0  2024-09-27   High\n18       28        108        5        6  27.0  2024-09-28    Low\n19       29        109        6        9  24.0  2024-09-29   High\n20       30        110        7        7  23.5  2024-09-30    Low\n21       31        101        4       13  14.5  2024-10-01   High\n22       32        102        5        6  29.0  2024-10-02    Low\n23       33        103        6        8  21.0  2024-10-03   High\n24       34        104        7        5  30.0  2024-10-04    Low\n25       35        105        4        7  15.0  2024-10-05   High\n26       36        106        5        3  25.0  2024-10-06    Low\n27       37        107        6       12  18.0  2024-10-07   High\n28       38        108        7        9  20.0  2024-10-08    Low\n29       39        109        8       10  22.0  2024-10-09   High\n30       40        110        9        6  26.0  2024-10-10    Low\n31       41        101        3        5  15.0  2024-10-11   High\n32       42        102        4        4  20.0  2024-10-12    Low\n33       43        103        5        9  19.0  2024-10-13   High\n34       44        104        6        7  28.0  2024-10-14    Low\n35       45        105        7       10  25.0  2024-10-15   High\n36       46        106        8        8  22.5  2024-10-16    Low\n37       47        107        9        6  24.0  2024-10-17   High\n38       48        108        1        3  27.0  2024-10-18    Low\n39       49        109        2       11  18.5  2024-10-19   High\n40       50        110        3       12  21.0  2024-10-20    Low\n41       60        110        4        9  17.0  2024-09-10    Low\nINFO     CommonUtilities.utils:utils.py:44 The actual data is:    sales_id product_id store_id quantity price   sale_date region\n0        10        110        4        9  17.0  2024-09-10    Low\n1        11        101        4       15  14.0  2024-09-11   High\n2        12        102        5        9  27.0  2024-09-12    Low\n3        13        103        6       10  22.0  2024-09-13   High\n4        14        104        7        8  31.0  2024-09-14    Low\n5        15        105        4       12  11.0  2024-09-15   High\n6        16        106        5        5  23.0  2024-09-16    Low\n7        17        107        6        3  26.0  2024-09-17   High\n8        18        108        7        6  28.0  2024-09-18    Low\n9        19        109        8       11  20.0  2024-09-19   High\n10       20        110        9        9  19.5  2024-09-20    Low\n11       21        101        1       14  15.5  2024-09-21   High\n12       22        102        2        8  22.0  2024-09-22    Low\n13       23        103        3        7  18.0  2024-09-23   High\n14       24        104        4        6  25.0  2024-09-24    Low\n15       25        105        2       12  13.5  2024-09-25   High\n16       26        106        3        5  21.0  2024-09-26    Low\n17       27        107        1       10  19.0  2024-09-27   High\n18       28        108        5        6  27.0  2024-09-28    Low\n19       29        109        6        9  24.0  2024-09-29   High\n20       30        110        7        7  23.5  2024-09-30    Low\n21       31        101        4       13  14.5  2024-10-01   High\n22       32        102        5        6  29.0  2024-10-02    Low\n23       33        103        6        8  21.0  2024-10-03   High\n24       34        104        7        5  30.0  2024-10-04    Low\n25       35        105        4        7  15.0  2024-10-05   High\n26       36        106        5        3  25.0  2024-10-06    Low\n27       37        107        6       12  18.0  2024-10-07   High\n28       38        108        7        9  20.0  2024-10-08    Low\n29       39        109        8       10  22.0  2024-10-09   High\n30       40        110        9        6  26.0  2024-10-10    Low\n31       41        101        3        5  15.0  2024-10-11   High\n32       42        102        4        4  20.0  2024-10-12    Low\n33       43        103        5        9  19.0  2024-10-13   High\n34       44        104        6        7  28.0  2024-10-14    Low\n35       45        105        7       10  25.0  2024-10-15   High\n36       46        106        8        8  22.5  2024-10-16    Low\n37       47        107        9        6  24.0  2024-10-17   High\n38       48        108        1        3  27.0  2024-10-18    Low\n39       49        109        2       11  18.5  2024-10-19   High\n40       50        110        3       12  21.0  2024-10-20    Low\n41       60        110        4        9  17.0  2024-09-10    Low\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:40 mysql connection has been closed..&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Router_Low_region_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Router_Low_region_check&#34;, &#34;duration&#34;: &#34;65 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Router_Low_region_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;65 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:40 Test cases execution for Router_Low transformation has started ....\nINFO     CommonUtilities.utils:utils.py:42 The expected data is :   sales_id product_id store_id quantity price   sale_date region\n0        10        110        4        9  17.0  2024-09-10    Low\n1        12        102        5        9  27.0  2024-09-12    Low\n2        14        104        7        8  31.0  2024-09-14    Low\n3        16        106        5        5  23.0  2024-09-16    Low\n4        18        108        7        6  28.0  2024-09-18    Low\n5        20        110        9        9  19.5  2024-09-20    Low\n6        22        102        2        8  22.0  2024-09-22    Low\n7        24        104        4        6  25.0  2024-09-24    Low\n8        26        106        3        5  21.0  2024-09-26    Low\n9        28        108        5        6  27.0  2024-09-28    Low\n10       30        110        7        7  23.5  2024-09-30    Low\n11       32        102        5        6  29.0  2024-10-02    Low\n12       34        104        7        5  30.0  2024-10-04    Low\n13       36        106        5        3  25.0  2024-10-06    Low\n14       38        108        7        9  20.0  2024-10-08    Low\n15       40        110        9        6  26.0  2024-10-10    Low\n16       42        102        4        4  20.0  2024-10-12    Low\n17       44        104        6        7  28.0  2024-10-14    Low\n18       46        106        8        8  22.5  2024-10-16    Low\n19       48        108        1        3  27.0  2024-10-18    Low\n20       50        110        3       12  21.0  2024-10-20    Low\n21       60        110        4        9  17.0  2024-09-10    Low\nINFO     CommonUtilities.utils:utils.py:44 The actual data is:    sales_id product_id store_id quantity price   sale_date region\n0        10        110        4        9  17.0  2024-09-10    Low\n1        12        102        5        9  27.0  2024-09-12    Low\n2        14        104        7        8  31.0  2024-09-14    Low\n3        16        106        5        5  23.0  2024-09-16    Low\n4        18        108        7        6  28.0  2024-09-18    Low\n5        20        110        9        9  19.5  2024-09-20    Low\n6        22        102        2        8  22.0  2024-09-22    Low\n7        24        104        4        6  25.0  2024-09-24    Low\n8        26        106        3        5  21.0  2024-09-26    Low\n9        28        108        5        6  27.0  2024-09-28    Low\n10       30        110        7        7  23.5  2024-09-30    Low\n11       32        102        5        6  29.0  2024-10-02    Low\n12       34        104        7        5  30.0  2024-10-04    Low\n13       36        106        5        3  25.0  2024-10-06    Low\n14       38        108        7        9  20.0  2024-10-08    Low\n15       40        110        9        6  26.0  2024-10-10    Low\n16       42        102        4        4  20.0  2024-10-12    Low\n17       44        104        6        7  28.0  2024-10-14    Low\n18       46        106        8        8  22.5  2024-10-16    Low\n19       48        108        1        3  27.0  2024-10-18    Low\n20       50        110        3       12  21.0  2024-10-20    Low\n21       60        110        4        9  17.0  2024-09-10    Low\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:40 mysql connection has been closed..&#34;}], &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Router_High_region_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Router_High_region_check&#34;, &#34;duration&#34;: &#34;69 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_DataTransformation.py::TestDataTransformation::test_DataTransformation_Router_High_region_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;69 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:34 mysql connection is being established...\nINFO     conftest:conftest.py:37 mysql connection has been established...\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_DataTransformation:test_DataTransformation.py:51 Test cases execution for Router_High transformation has started ....\nINFO     CommonUtilities.utils:utils.py:42 The expected data is :   sales_id product_id store_id quantity price   sale_date region\n0        11        101        4       15  14.0  2024-09-11   High\n1        13        103        6       10  22.0  2024-09-13   High\n2        15        105        4       12  11.0  2024-09-15   High\n3        17        107        6        3  26.0  2024-09-17   High\n4        19        109        8       11  20.0  2024-09-19   High\n5        21        101        1       14  15.5  2024-09-21   High\n6        23        103        3        7  18.0  2024-09-23   High\n7        25        105        2       12  13.5  2024-09-25   High\n8        27        107        1       10  19.0  2024-09-27   High\n9        29        109        6        9  24.0  2024-09-29   High\n10       31        101        4       13  14.5  2024-10-01   High\n11       33        103        6        8  21.0  2024-10-03   High\n12       35        105        4        7  15.0  2024-10-05   High\n13       37        107        6       12  18.0  2024-10-07   High\n14       39        109        8       10  22.0  2024-10-09   High\n15       41        101        3        5  15.0  2024-10-11   High\n16       43        103        5        9  19.0  2024-10-13   High\n17       45        105        7       10  25.0  2024-10-15   High\n18       47        107        9        6  24.0  2024-10-17   High\n19       49        109        2       11  18.5  2024-10-19   High\nINFO     CommonUtilities.utils:utils.py:44 The actual data is:    sales_id product_id store_id quantity price   sale_date region\n0        11        101        4       15  14.0  2024-09-11   High\n1        13        103        6       10  22.0  2024-09-13   High\n2        15        105        4       12  11.0  2024-09-15   High\n3        17        107        6        3  26.0  2024-09-17   High\n4        19        109        8       11  20.0  2024-09-19   High\n5        21        101        1       14  15.5  2024-09-21   High\n6        23        103        3        7  18.0  2024-09-23   High\n7        25        105        2       12  13.5  2024-09-25   High\n8        27        107        1       10  19.0  2024-09-27   High\n9        29        109        6        9  24.0  2024-09-29   High\n10       31        101        4       13  14.5  2024-10-01   High\n11       33        103        6        8  21.0  2024-10-03   High\n12       35        105        4        7  15.0  2024-10-05   High\n13       37        107        6       12  18.0  2024-10-07   High\n14       39        109        8       10  22.0  2024-10-09   High\n15       41        101        3        5  15.0  2024-10-11   High\n16       43        103        5        9  19.0  2024-10-13   High\n17       45        105        7       10  25.0  2024-10-15   High\n18       47        107        9        6  24.0  2024-10-17   High\n19       49        109        2       11  18.5  2024-10-19   High\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:40 mysql connection has been closed..&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;testReport.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>